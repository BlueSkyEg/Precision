<app-top-nav [items]="breadcrumbItems" pcName="Computer" userName="Miral sobhy" [user]="true" />
<div class="sm:hidden">
  <label for="tabs" class="sr-only">Select your country</label>
  <select id="tabs" class="bg-gray-50 border border-gray-300 text-gray-400 text-sm rounded-sm">
    <option>Profile</option>
    <option>Dashboard</option>
    <option>setting</option>
  </select>
</div>
<ul class="font-semibold text-center text-gray-400 hidden border w-fit border-gray-300 sm:flex mt-12 rounded-md">
  <li (click)="selectTab('Pending')"
    class="select-none bg-gray-100 inline-block px-4 py-2 border-r border-gray-300 rounded-l-md focus:ring-4 active focus:outline-none cursor-pointer"
    [ngClass]="{
         'text-primary': selectedTab === 'Pending',
         'bg-white': selectedTab === 'Pending',
       }">
    Pending
  </li>
  <li (click)="selectTab('Updated')"
    class="select-none inline-block px-4 py-2 bg-gray-100 border-r border-gray-300 focus:outline-none cursor-pointer"
    [ngClass]="{
         'text-primary': selectedTab === 'Updated',
         'bg-white': selectedTab === 'Updated',
       }">
    Updated
  </li>
  <li [ngClass]="{
         'text-primary': selectedTab === 'History',
         'bg-white': selectedTab === 'History',
       }" (click)="selectTab('History')"
    class="select-none inline-block px-4 py-2 bg-gray-100 rounded-r-md focus:outline-none cursor-pointer">
    History
  </li>
</ul>
<div *ngIf="selectedTab === 'Pending'" class="">
  <div class="flex justify-between items-center">
    <div class="max-w-sm my-6 flex gap-2 items-center">
      <div class="relative flex-1">
        <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
          <app-navigation-icon iconType="search" iconName="search-icon" class="text-white" />
        </div>
        <input type="search" id="default-search"
          class="block w-full max-w-full ps-10 pe-4 py-3 text-sm text-gray-400 border border-gray-300 rounded-lg focus:outline-none focus:ring-primary focus:border-primary focus:border-2 placeholder:text-gray-400 placeholder:font-semibold"
          placeholder="Search transactions" />
      </div>
      <div class="border border-gray-300 p-3 rounded-md cursor-pointer hover:bg-gray-100" (click)="openFilter()">
        <app-navigation-icon iconType="common" iconName="filter" />
      </div>
    </div>
    @if(selectedAccountsCount>0){
    <div class="flex gap-2 items-center">
      <span class="text-gray-400 font-semibold text-sm"> {{selectedAccountsCount}} Selected</span>
      <button
        class="bg-primary text-white text-sm font-semibold py-2 px-3 rounded-md hover:bg-[#2B51B2] disabled:bg-[#3360d379]"
        (click)="openFilter()">
        Choose Account
      </button>
    </div>
    }
  </div>

  <div class="relative overflow-x-auto">
    <div class="border border-gray-300 rounded-md overflow-hidden">
      <table class="w-full text-sm text-left text-black font-semibold">
        <thead class="bg-gray-100 border-b border-gray-300">
          <tr>
            <th scope="col" class="p-4">
              <div class="flex items-center">
                <input #selectAllCheckbox id="checkbox-all-search" type="checkbox"
                  class="w-4 h-4 text-primary border border-gray-300 rounded"
                  (change)="toggleSelectAll(selectAllCheckbox.checked)" />
                <label for="checkbox-all-search" class="sr-only">checkbox</label>
              </div>
            </th>
            <th scope="col" class="pe-4">Name</th>
            <th scope="col" class="pe-4">Date</th>
            <th scope="col" class="pe-4">CHK</th>
            <th scope="col" class="pe-4">Type</th>
            <th scope="col" class="pe-4">Amount</th>
            <th scope="col" class="pe-4">Source</th>
            <th scope="col" class="pe-4">Comment</th>
            <th scope="col" class="pe-4">Classification/Account</th>
            <th scope="col" class="pe-4">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for(item of PaginatedData ; track $index){
          <tr class="border-b border-gray-300 last:border-0">
            <td class="w-4 px-4 py-4">
              <div class="flex items-center">
                <input type="checkbox" [checked]="item.selected" (change)="toggleSelection(item)"
                  class="w-4 h-4 text-blue-600 border border-gray-300 rounded cursor-pointer" />
                <label class="sr-only">Select {{ item.name }}</label>
              </div>
            </td>
            <td class="pe-4 py-4">{{ item.name }}</td>
            <td class="pe-4 py-4 text-gray-400">{{ item.date }}</td>

            <td class="pe-4 py-4 text-center">{{ item.chk }}</td>
            <td class="pe-4 py-4">{{ item.type }}</td>
            <td class="text-[#FF0000] pe-4 py-4">$({{ item.amount }})</td>

            <td class="pe-4 py-4 text-gray-400">PNC CHK - 3775</td>
            <td class="truncate max-w-custom pe-4 py-4 text-gray-400">
              {{ item.comment }}
            </td>
            <td class="pe-4 py-4">
              <select id="countries"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                <option selected>Suspense</option>
                <option value="US">United States</option>
                <option value="CA">Canada</option>
                <option value="FR">France</option>
                <option value="DE">Germany</option>
              </select>
            </td>
            <td class="pe-4">
              <button
                class="bg-primary text-white text-sm font-semibold py-2 px-3 rounded-md hover:bg-[#2B51B2] disabled:bg-[#3360d379]">
                Update
              </button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>
<div *ngIf="selectedTab === 'Updated'" class="mt-4">Content for Updated</div>
<div *ngIf="selectedTab === 'History'" class="mt-4">Content for History</div>
<!-- Modal -->
<div class="fixed top-3 right-3 bottom-0 w-[400px] rounded-2xl p-6 bg-white transition-all duration-500 transform z-50"
  [ngClass]="{
    'translate-x-full': !filterVisible,
    'translate-x-0': filterVisible
  }">
  <div class="flex items-center justify-between mb-8">
    <span class="font-medium text-xl">Filters</span>
    <div class="border border-gray-300 rounded-md p-[10px] cursor-pointer hover:bg-gray-100" (click)="closeFilter()">
      <app-navigation-icon iconType="common" iconName="close" class="text-gray-400" />
    </div>
  </div>
  <form class="flex flex-col h-[92%]">
    <div class="flex-grow">
      <div class="mb-4">
        <label for="name" class="block mb-2 font-medium text-black">Name</label>
        <input type="text" placeholder="Type name" id="name"
          class="border text-gray-400 placeholder:text-gray-400 placeholder:font-semibold border-gray-300 rounded-md focus:outline-none block w-full p-2.5" />
      </div>
      <div class="mb-4">
        <label for="amount" class="block mb-2 font-medium text-black">Amount</label>
      </div>
      <div class="mb-4">
        <label for="date" class="block mb-2 font-medium text-black">Date Range</label>
        <mat-form-field class="w-full !bg-white border-0">
          <mat-date-range-input [rangePicker]="picker" [min]="minDate" [max]="maxDate">
            <input matStartDate placeholder="From" class="placeholder:text-gray-400 placeholder:font-semibold">
            <input matEndDate placeholder=" To" class="placeholder:text-gray-400 placeholder:font-semibold">
          </mat-date-range-input>
          <mat-datepicker-toggle class="w-full" matIconSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-date-range-picker #picker></mat-date-range-picker>
        </mat-form-field>

      </div>
    </div>
    <div class="flex justify-between items-center">
      <button
        class="bg-white border border-gray-300 text-sm py-[10px] w-[168px] rounded-md text-black hover:bg-gray-100"
        (click)="closeFilter($event)">
        Close
      </button>
      <button class="bg-primary text-sm py-[10px] w-[168px] rounded-md hover:bg-[#2B51B2] text-white">
        Show Results
      </button>
    </div>
  </form>
</div>
<!-- overlay -->
<div class="top-0 end-0 bottom-0 start-0 z-10 transition-all duration-500" [ngClass]="{
    'bg-opacity-0': !filterVisible,
    'fixed bg-black bg-opacity-35': filterVisible
  }"></div>

<!-- paginator -->
<nav class="mt-6">
  <div class="flex items-center justify-between">
    <ul class="flex items-center -space-x-px h-10 text-base">
      @if(currentPage>1){
      <li (click)="changePage(1)" class="cursor-pointer">
        <a
          class="flex items-center justify-center px-4 h-10 ms-0 leading-tight text-gray-400 font-semibold text-sm bg-white border border-e-0 border-gray-300 rounded-s-md hover:bg-gray-100 hover:text-primary">
          <span class="sr-only">firstPage</span>
          <app-navigation-icon class="rotate-180" iconType="common" iconName="double-prev-next" />
        </a>
      </li>
      <li (click)="changePage(currentPage - 1)" class="cursor-pointer">
        <a
          class="flex items-center justify-center px-4 h-10 leading-tight text-gray-400 font-semibold text-sm bg-white border border-gray-300 hover:bg-gray-100 hover:text-primary">
          <span class="sr-only">Previous</span>
          <app-navigation-icon class="rotate-180" iconType="common" iconName="prev-next" />
        </a>
      </li>
      }

      @for( page of visiblePages;track $index){
      <li (click)="changePage(page)" class="cursor-pointer">
        <a [ngClass]="{
      '!bg-gray-100 !text-primary': currentPage == page,
        'rounded-s-md': page === 1&& currentPage == page,
        'rounded-e-md':page === totalPages&& currentPage == totalPages
            }"
          class="flex items-center justify-center px-4 h-10 leading-tight text-gray-400 font-semibold text-sm bg-white border border-gray-300 hover:bg-gray-100 hover:text-primary">
          {{ page }}
        </a>
      </li>
      }
      @if(currentPage<totalPages){ <li (click)="changePage(currentPage + 1)" class="cursor-pointer">
        <a
          class="flex items-center justify-center px-4 h-10 leading-tight text-gray-400 font-semibold text-sm bg-white border border-gray-300 hover:bg-gray-100 hover:text-primary">
          <span class="sr-only">Next</span>
          <app-navigation-icon iconType="common" iconName="prev-next" />
        </a>
        </li>
        <li (click)="changePage(totalPages)" class="cursor-pointer">
          <a
            class="flex items-center justify-center px-4 h-10 leading-tight text-gray-400 font-semibold text-sm bg-white border border-gray-300 rounded-e-md hover:bg-gray-100 hover:text-primary">
            <span class="sr-only">LastPage</span>
            <app-navigation-icon iconType="common" iconName="double-prev-next" />
          </a>
        </li>
        }
    </ul>
    <div class="border border-gray-300 rounded-md font-semibold flex">
      <div class="p-3  border-r border-gray-300">1-{{itemsPerPage}} <span class="text-gray-400 pe-3">of
          {{transactions.length}}</span>
      </div>
      <div class="relative ps-3">
        <button id="dropdownButton" class="py-3 px-3 rounded-e-md focus:outline-none" (click)="toggleDropdown()">
          {{ selectedOption }}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 inline-block ml-2" fill="none" stroke="currentColor"
            viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>
        @if(dropdownVisible)
        {
        <div class="absolute mt-1 start-0 w-full bg-white border border-gray-300 rounded-md shadow-sm z-10 px-1 ">
          @for( option of options ;track $index)
          {
          <div class="px-3 py-1 cursor-pointer hover:bg-gray-100 text-gray-400" (click)="selectOption(option)">
            {{ option }}
          </div>}
        </div>}
      </div>

    </div>
  </div>
</nav>
